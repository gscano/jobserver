.TH JOBSERVER 3

.SH NAME
jobserver_getenv, jobserver_setenv, jobserver_unsetenv - access the jobserver environment
variable

.SH SYNOPSIS
.nf
#include <jobserver.h>
.sp
.B "int jobserver_getenv(struct jobserver * \fIjs\fP);"
.br
.B "int jobserver_setenv(struct jobserver const * \fIjs\fP);"
.br
.B "int jobserver_unsetenv(struct jobserver const * \fIjs\fP);"

.SH DESCRIPTION
The
.BR jobserver_getenv (),
.BR jobserver_setenv (),
and
.BR jobserver_putenv ()
functions respectively fetch, set and erase a jobserver \fIjs\fP
from the environment.

The \fIdry_run\fP, \fIdebug\fP, and \fIkeep_going\fP statuses of the jobserver
\fIjs\fP (see \fBjobserver\fP(7)), if present,
are always collected or set even when the jobserver is unset.

.SH RETURN VALUE
On success, these functions return \fB0\fP. On error, \fP-1\fP is returned and
.I errno
is set accordingly.

.SH ERROR

.TP
.B EBADF
(\fBjobserver_getenv\fP())
One of the token pipe file descriptor could not be parsed.

.TP
.B ENOMEM
(\fBjobserver_setenv\fP(), \fBjobserver_unsetenv\fP())
Not enough memory to add or change the \fBMAKEFLAGS\fP environment variable.

.SH ENVIRONMENT
According to section 13.1.1 of the
.UR https://www.gnu.org/software/make/
GNU Make documentation
.UE ,
those fonctions respectively read and write the
.B MAKEFLAGS
environment variable. In particular, the letters \(aqn\(aq, \(aqd\(aq and \(aqk\(aq,
corresponding to the \fIdry_run\fP, \fIdebug\fP, and \fIkeep_going\fP options,
are looked up or inserted in the first word of this variable. The
\fIread\fP and \fIwrite\fP file descriptors of the token pipe are looked up
or written in the
.B --jobserver-auth=\fP\fIread\fP,\fIwrite\fP
string.

.SH ATTRIBUTES
For an explanation of the terms used in this section, see
.BR attributes (7).
.ad l
.TS
allbox;
lb lb lb
l l l.
Interface	Attribute	Value
T{
.BR jobserver_getenv ()
T}	Thread safety	MT-Safe env, locale
T{
.BR jobserver_setenv ()
T}	Thread safety	MT-Unsafe const:env
.TE
.ad

.SH SEE ALSO
.BR jobserver (7)
